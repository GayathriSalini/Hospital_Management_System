{% extends 'layout.html' %}
{% block body_class %} landing-page {% endblock %}
{% block title %} Doctor-My Appointments | NHS Hospital {% endblock %}

{% block navbar %}
<div class="container nav_bar">
    <div class="d-flex justify-content-between align-items-center mt-2">
        <div><a href="{{ url_for('main.landing_page') }}"><strong>NHS |</strong> &nbsp; Health Management System</a></div>
        <div><a href="{{ url_for('doctor.dashboard') }}">TODAY'S APPOINTMENT | ‚Üê Back to Dashboard </a></div>
    </div>
</div>
{% endblock %}


{% block content %}
<div class="main_container list_appo mx-3 bg-white p-4" style="min-height: calc(100vh - 75px);">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %}
   {% endif %}
 {% endwith %} 
     <table class="table table-hover">
     <thead>
     <tr>
       <th>Time</th>
       <th>Patient Name</th>
       <th>Status</th>
       <th>Actions</th>
     </tr>
     </thead>

     <tbody>
     {% for appt in daily_appointments %}
     <tr>
       <td>{{ appt.appo_date.strftime('%Y-%m-%d') }} {{ appt.appo_time.strftime('%H:%M') }}</td>
       <td>{{ appt.patient.p_name if appt.patient else 'N/A' }}</td>
       <td>{{ appt.status }}</td>
       <td>
          <div class="d-flex gap-2 action-buttons">
            <button class="btn btn-view" onclick="alert('View History Coming Soon')">View History</button>
            <button class="btn btn-add" onclick="alert('Add Treatment Coming Soon')">Add Treatment</button>
        
            <form method="POST" action="{{ url_for('doctor.mark_status', appo_id=appt.appo_id, status='Completed') }}">
              <button type="submit" class="btn btn-complete">Mark Complete</button>
            </form>
        
            <form method="POST" action="{{ url_for('doctor.mark_status', appo_id=appt.appo_id, status='Cancelled') }}"
                  onsubmit="return confirm('Are you sure you want to cancel this appointment?');">
              <button type="submit" class="btn btn-cancel">Cancel</button>
            </form>
          </div>
       
       </td>
     </tr>
     {% else %}
     <tr><td colspan="4">No appointments found.</td></tr>
     {% endfor %}
   </tbody>

    </table>

</div>
      

{% endblock %}